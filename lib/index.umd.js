!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("vue")):"function"==typeof define&&define.amd?define(["exports","vue"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).FE_utils={},e.vue)}(this,(function(e,t){"use strict";var r=function(){return r=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)};function n(e,t,r){void 0===r&&(r={});var n={type:"Feature"};return(0===r.id||r.id)&&(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=t||{},n.geometry=e,n}function i(e,t,r){if(void 0===r&&(r={}),!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!l(e[0])||!l(e[1]))throw new Error("coordinates must contain numbers");return n({type:"Point",coordinates:e},t,r)}function o(e,t,r){void 0===r&&(r={});for(var i=0,o=e;i<o.length;i++){var a=o[i];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<a[a.length-1].length;s++)if(a[a.length-1][s]!==a[0][s])throw new Error("First and last Position are not equivalent.")}return n({type:"Polygon",coordinates:e},t,r)}function a(e,t,r){if(void 0===r&&(r={}),e.length<2)throw new Error("coordinates must be an array of two or more positions");return n({type:"LineString",coordinates:e},t,r)}function s(e,t){void 0===t&&(t={});var r={type:"FeatureCollection"};return t.id&&(r.id=t.id),t.bbox&&(r.bbox=t.bbox),r.features=e,r}function u(e){return e%360*Math.PI/180}function l(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)}function c(e,t,r){if(null!==e)for(var n,i,o,a,s,u,l,h,f=0,d=0,m=e.type,p="FeatureCollection"===m,g="Feature"===m,v=p?e.features.length:1,y=0;y<v;y++){s=(h=!!(l=p?e.features[y].geometry:g?e.geometry:e)&&"GeometryCollection"===l.type)?l.geometries.length:1;for(var x=0;x<s;x++){var b=0,M=0;if(null!==(a=h?l.geometries[x]:l)){u=a.coordinates;var w=a.type;switch(f=!r||"Polygon"!==w&&"MultiPolygon"!==w?0:1,w){case null:break;case"Point":if(!1===t(u,d,y,b,M))return!1;d++,b++;break;case"LineString":case"MultiPoint":for(n=0;n<u.length;n++){if(!1===t(u[n],d,y,b,M))return!1;d++,"MultiPoint"===w&&b++}"LineString"===w&&b++;break;case"Polygon":case"MultiLineString":for(n=0;n<u.length;n++){for(i=0;i<u[n].length-f;i++){if(!1===t(u[n][i],d,y,b,M))return!1;d++}"MultiLineString"===w&&b++,"Polygon"===w&&M++}"Polygon"===w&&b++;break;case"MultiPolygon":for(n=0;n<u.length;n++){for(M=0,i=0;i<u[n].length;i++){for(o=0;o<u[n][i].length-f;o++){if(!1===t(u[n][i][o],d,y,b,M))return!1;d++}M++}b++}break;case"GeometryCollection":for(n=0;n<a.geometries.length;n++)if(!1===c(a.geometries[n],t,r))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function h(e,t){if("Feature"===e.type)t(e,0);else if("FeatureCollection"===e.type)for(var r=0;r<e.features.length&&!1!==t(e.features[r],r);r++);}function f(e,t){var r,n,i,o,a,s,u,l,c,h,f=0,d="FeatureCollection"===e.type,m="Feature"===e.type,p=d?e.features.length:1;for(r=0;r<p;r++){for(s=d?e.features[r].geometry:m?e.geometry:e,l=d?e.features[r].properties:m?e.properties:{},c=d?e.features[r].bbox:m?e.bbox:void 0,h=d?e.features[r].id:m?e.id:void 0,a=(u=!!s&&"GeometryCollection"===s.type)?s.geometries.length:1,i=0;i<a;i++)if(null!==(o=u?s.geometries[i]:s))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===t(o,f,l,c,h))return!1;break;case"GeometryCollection":for(n=0;n<o.geometries.length;n++)if(!1===t(o.geometries[n],f,l,c,h))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===t(null,f,l,c,h))return!1;f++}}function d(e){var t=[1/0,1/0,-1/0,-1/0];return c(e,(function(e){t[0]>e[0]&&(t[0]=e[0]),t[1]>e[1]&&(t[1]=e[1]),t[2]<e[0]&&(t[2]=e[0]),t[3]<e[1]&&(t[3]=e[1])})),t}function m(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if("Feature"===e.type&&null!==e.geometry&&"Point"===e.geometry.type)return e.geometry.coordinates;if("Point"===e.type)return e.coordinates}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function p(e){if(Array.isArray(e))return e;if("Feature"===e.type){if(null!==e.geometry)return e.geometry.coordinates}else if(e.coordinates)return e.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function g(e,t){return"FeatureCollection"===e.type?"FeatureCollection":"GeometryCollection"===e.type?"GeometryCollection":"Feature"===e.type&&null!==e.geometry?e.geometry.type:e.type}"function"==typeof SuppressedError&&SuppressedError,d.default=d;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function v(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function y(e){if(e.__esModule)return e;var t=e.default;if("function"==typeof t){var r=function e(){return this instanceof e?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach((function(t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})})),r}var x={exports:{}};function b(e,t,r,n,i){M(e,t,r||0,n||e.length-1,i||P)}function M(e,t,r,n,i){for(;n>r;){if(n-r>600){var o=n-r+1,a=t-r+1,s=Math.log(o),u=.5*Math.exp(2*s/3),l=.5*Math.sqrt(s*u*(o-u)/o)*(a-o/2<0?-1:1);M(e,t,Math.max(r,Math.floor(t-a*u/o+l)),Math.min(n,Math.floor(t+(o-a)*u/o+l)),i)}var c=e[t],h=r,f=n;for(w(e,r,t),i(e[n],c)>0&&w(e,r,n);h<f;){for(w(e,h,f),h++,f--;i(e[h],c)<0;)h++;for(;i(e[f],c)>0;)f--}0===i(e[r],c)?w(e,r,f):w(e,++f,n),f<=t&&(r=f+1),t<=f&&(n=f-1)}}function w(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function P(e,t){return e<t?-1:e>t?1:0}function E(e,t,r){if(!r)return t.indexOf(e);for(let n=0;n<t.length;n++)if(r(e,t[n]))return n;return-1}function L(e,t){_(e,0,e.children.length,t,e)}function _(e,t,r,n,i){i||(i=I(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(let o=t;o<r;o++){const t=e.children[o];S(i,e.leaf?n(t):t)}return i}function S(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function X(e,t){return e.minX-t.minX}function Y(e,t){return e.minY-t.minY}function B(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function k(e){return e.maxX-e.minX+(e.maxY-e.minY)}function A(e,t){const r=Math.max(e.minX,t.minX),n=Math.max(e.minY,t.minY),i=Math.min(e.maxX,t.maxX),o=Math.min(e.maxY,t.maxY);return Math.max(0,i-r)*Math.max(0,o-n)}function F(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function C(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function I(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function O(e,t,r,n,i){const o=[t,r];for(;o.length;){if((r=o.pop())-(t=o.pop())<=n)continue;const a=t+Math.ceil((r-t)/n/2)*n;b(e,a,t,r,i),o.push(t,a,a,r)}}var R=Object.freeze({__proto__:null,default:class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const r=[];if(!C(e,t))return r;const n=this.toBBox,i=[];for(;t;){for(let o=0;o<t.children.length;o++){const a=t.children[o],s=t.leaf?n(a):a;C(e,s)&&(t.leaf?r.push(a):F(e,s)?this._all(a,r):i.push(a))}t=i.pop()}return r}collides(e){let t=this.data;if(!C(e,t))return!1;const r=[];for(;t;){for(let n=0;n<t.children.length;n++){const i=t.children[n],o=t.leaf?this.toBBox(i):i;if(C(e,o)){if(t.leaf||F(e,o))return!0;r.push(i)}}t=r.pop()}return!1}load(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(let t=0;t<e.length;t++)this.insert(e[t]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const e=this.data;this.data=t,t=e}this._insert(t,this.data.height-t.height-1,!0)}else this.data=t;return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=I([]),this}remove(e,t){if(!e)return this;let r=this.data;const n=this.toBBox(e),i=[],o=[];let a,s,u;for(;r||i.length;){if(r||(r=i.pop(),s=i[i.length-1],a=o.pop(),u=!0),r.leaf){const n=E(e,r.children,t);if(-1!==n)return r.children.splice(n,1),i.push(r),this._condense(i),this}u||r.leaf||!F(r,n)?s?(a++,r=s.children[a],u=!1):r=null:(i.push(r),o.push(a),a=0,s=r,r=r.children[0])}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const r=[];for(;e;)e.leaf?t.push(...e.children):r.push(...e.children),e=r.pop();return t}_build(e,t,r,n){const i=r-t+1;let o,a=this._maxEntries;if(i<=a)return o=I(e.slice(t,r+1)),L(o,this.toBBox),o;n||(n=Math.ceil(Math.log(i)/Math.log(a)),a=Math.ceil(i/Math.pow(a,n-1))),o=I([]),o.leaf=!1,o.height=n;const s=Math.ceil(i/a),u=s*Math.ceil(Math.sqrt(a));O(e,t,r,u,this.compareMinX);for(let i=t;i<=r;i+=u){const t=Math.min(i+u-1,r);O(e,i,t,s,this.compareMinY);for(let r=i;r<=t;r+=s){const i=Math.min(r+s-1,t);o.children.push(this._build(e,r,i,n-1))}}return L(o,this.toBBox),o}_chooseSubtree(e,t,r,n){for(;n.push(t),!t.leaf&&n.length-1!==r;){let r,n=1/0,a=1/0;for(let s=0;s<t.children.length;s++){const u=t.children[s],l=B(u),c=(i=e,o=u,(Math.max(o.maxX,i.maxX)-Math.min(o.minX,i.minX))*(Math.max(o.maxY,i.maxY)-Math.min(o.minY,i.minY))-l);c<a?(a=c,n=l<n?l:n,r=u):c===a&&l<n&&(n=l,r=u)}t=r||t.children[0]}var i,o;return t}_insert(e,t,r){const n=r?e:this.toBBox(e),i=[],o=this._chooseSubtree(n,this.data,t,i);for(o.children.push(e),S(o,n);t>=0&&i[t].children.length>this._maxEntries;)this._split(i,t),t--;this._adjustParentBBoxes(n,i,t)}_split(e,t){const r=e[t],n=r.children.length,i=this._minEntries;this._chooseSplitAxis(r,i,n);const o=this._chooseSplitIndex(r,i,n),a=I(r.children.splice(o,r.children.length-o));a.height=r.height,a.leaf=r.leaf,L(r,this.toBBox),L(a,this.toBBox),t?e[t-1].children.push(a):this._splitRoot(r,a)}_splitRoot(e,t){this.data=I([e,t]),this.data.height=e.height+1,this.data.leaf=!1,L(this.data,this.toBBox)}_chooseSplitIndex(e,t,r){let n,i=1/0,o=1/0;for(let a=t;a<=r-t;a++){const t=_(e,0,a,this.toBBox),s=_(e,a,r,this.toBBox),u=A(t,s),l=B(t)+B(s);u<i?(i=u,n=a,o=l<o?l:o):u===i&&l<o&&(o=l,n=a)}return n||r-t}_chooseSplitAxis(e,t,r){const n=e.leaf?this.compareMinX:X,i=e.leaf?this.compareMinY:Y;this._allDistMargin(e,t,r,n)<this._allDistMargin(e,t,r,i)&&e.children.sort(n)}_allDistMargin(e,t,r,n){e.children.sort(n);const i=this.toBBox,o=_(e,0,t,i),a=_(e,r-t,r,i);let s=k(o)+k(a);for(let n=t;n<r-t;n++){const t=e.children[n];S(o,e.leaf?i(t):t),s+=k(o)}for(let n=r-t-1;n>=t;n--){const t=e.children[n];S(a,e.leaf?i(t):t),s+=k(a)}return s}_adjustParentBBoxes(e,t,r){for(let n=r;n>=0;n--)S(t[n],e)}_condense(e){for(let t,r=e.length-1;r>=0;r--)0===e[r].children.length?r>0?(t=e[r-1].children,t.splice(t.indexOf(e[r]),1)):this.clear():L(e[r],this.toBBox)}}}),N=y(R);function j(e,t){return e<t?-1:e>t?1:0}var D=y(Object.freeze({__proto__:null,default:class{constructor(e=[],t=j){if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let e=(this.length>>1)-1;e>=0;e--)this._down(e)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:t,compare:r}=this,n=t[e];for(;e>0;){const i=e-1>>1,o=t[i];if(r(n,o)>=0)break;t[e]=o,e=i}t[e]=n}_down(e){const{data:t,compare:r}=this,n=this.length>>1,i=t[e];for(;e<n;){let n=1+(e<<1),o=t[n];const a=n+1;if(a<this.length&&r(t[a],o)<0&&(n=a,o=t[a]),r(o,i)>=0)break;t[e]=o,e=n}t[e]=i}}})),z={exports:{}},T=function(e,t,r,n){var i=e[0],o=e[1],a=!1;void 0===r&&(r=0),void 0===n&&(n=t.length);for(var s=(n-r)/2,u=0,l=s-1;u<s;l=u++){var c=t[r+2*u+0],h=t[r+2*u+1],f=t[r+2*l+0],d=t[r+2*l+1];h>o!=d>o&&i<(f-c)*(o-h)/(d-h)+c&&(a=!a)}return a},G=function(e,t,r,n){var i=e[0],o=e[1],a=!1;void 0===r&&(r=0),void 0===n&&(n=t.length);for(var s=n-r,u=0,l=s-1;u<s;l=u++){var c=t[u+r][0],h=t[u+r][1],f=t[l+r][0],d=t[l+r][1];h>o!=d>o&&i<(f-c)*(o-h)/(d-h)+c&&(a=!a)}return a};z.exports=function(e,t,r,n){return t.length>0&&Array.isArray(t[0])?G(e,t,r,n):T(e,t,r,n)},z.exports.nested=G,z.exports.flat=T;var q=z.exports,J={exports:{}};!function(e,t){!function(e){const t=134217729,r=33306690738754706e-32;function n(e,t,r,n,i){let o,a,s,u,l=t[0],c=n[0],h=0,f=0;c>l==c>-l?(o=l,l=t[++h]):(o=c,c=n[++f]);let d=0;if(h<e&&f<r)for(c>l==c>-l?(s=o-((a=l+o)-l),l=t[++h]):(s=o-((a=c+o)-c),c=n[++f]),o=a,0!==s&&(i[d++]=s);h<e&&f<r;)c>l==c>-l?(s=o-((a=o+l)-(u=a-o))+(l-u),l=t[++h]):(s=o-((a=o+c)-(u=a-o))+(c-u),c=n[++f]),o=a,0!==s&&(i[d++]=s);for(;h<e;)s=o-((a=o+l)-(u=a-o))+(l-u),l=t[++h],o=a,0!==s&&(i[d++]=s);for(;f<r;)s=o-((a=o+c)-(u=a-o))+(c-u),c=n[++f],o=a,0!==s&&(i[d++]=s);return 0===o&&0!==d||(i[d++]=o),d}function i(e){return new Float64Array(e)}const o=33306690738754716e-32,a=22204460492503146e-32,s=11093356479670487e-47,u=i(4),l=i(8),c=i(12),h=i(16),f=i(4);e.orient2d=function(e,i,d,m,p,g){const v=(i-g)*(d-p),y=(e-p)*(m-g),x=v-y;if(0===v||0===y||v>0!=y>0)return x;const b=Math.abs(v+y);return Math.abs(x)>=o*b?x:-function(e,i,o,d,m,p,g){let v,y,x,b,M,w,P,E,L,_,S,X,Y,B,k,A,F,C;const I=e-m,O=o-m,R=i-p,N=d-p;M=(k=(E=I-(P=(w=t*I)-(w-I)))*(_=N-(L=(w=t*N)-(w-N)))-((B=I*N)-P*L-E*L-P*_))-(S=k-(F=(E=R-(P=(w=t*R)-(w-R)))*(_=O-(L=(w=t*O)-(w-O)))-((A=R*O)-P*L-E*L-P*_))),u[0]=k-(S+M)+(M-F),M=(Y=B-((X=B+S)-(M=X-B))+(S-M))-(S=Y-A),u[1]=Y-(S+M)+(M-A),M=(C=X+S)-X,u[2]=X-(C-M)+(S-M),u[3]=C;let j=function(e,t){let r=t[0];for(let n=1;n<e;n++)r+=t[n];return r}(4,u),D=a*g;if(j>=D||-j>=D)return j;if(v=e-(I+(M=e-I))+(M-m),x=o-(O+(M=o-O))+(M-m),y=i-(R+(M=i-R))+(M-p),b=d-(N+(M=d-N))+(M-p),0===v&&0===y&&0===x&&0===b)return j;if(D=s*g+r*Math.abs(j),(j+=I*b+N*v-(R*x+O*y))>=D||-j>=D)return j;M=(k=(E=v-(P=(w=t*v)-(w-v)))*(_=N-(L=(w=t*N)-(w-N)))-((B=v*N)-P*L-E*L-P*_))-(S=k-(F=(E=y-(P=(w=t*y)-(w-y)))*(_=O-(L=(w=t*O)-(w-O)))-((A=y*O)-P*L-E*L-P*_))),f[0]=k-(S+M)+(M-F),M=(Y=B-((X=B+S)-(M=X-B))+(S-M))-(S=Y-A),f[1]=Y-(S+M)+(M-A),M=(C=X+S)-X,f[2]=X-(C-M)+(S-M),f[3]=C;const z=n(4,u,4,f,l);M=(k=(E=I-(P=(w=t*I)-(w-I)))*(_=b-(L=(w=t*b)-(w-b)))-((B=I*b)-P*L-E*L-P*_))-(S=k-(F=(E=R-(P=(w=t*R)-(w-R)))*(_=x-(L=(w=t*x)-(w-x)))-((A=R*x)-P*L-E*L-P*_))),f[0]=k-(S+M)+(M-F),M=(Y=B-((X=B+S)-(M=X-B))+(S-M))-(S=Y-A),f[1]=Y-(S+M)+(M-A),M=(C=X+S)-X,f[2]=X-(C-M)+(S-M),f[3]=C;const T=n(z,l,4,f,c);M=(k=(E=v-(P=(w=t*v)-(w-v)))*(_=b-(L=(w=t*b)-(w-b)))-((B=v*b)-P*L-E*L-P*_))-(S=k-(F=(E=y-(P=(w=t*y)-(w-y)))*(_=x-(L=(w=t*x)-(w-x)))-((A=y*x)-P*L-E*L-P*_))),f[0]=k-(S+M)+(M-F),M=(Y=B-((X=B+S)-(M=X-B))+(S-M))-(S=Y-A),f[1]=Y-(S+M)+(M-A),M=(C=X+S)-X,f[2]=X-(C-M)+(S-M),f[3]=C;const G=n(T,c,4,f,h);return h[G-1]}(e,i,d,m,p,g,b)},e.orient2dfast=function(e,t,r,n,i,o){return(t-o)*(r-i)-(e-i)*(n-o)},Object.defineProperty(e,"__esModule",{value:!0})}(t)}(0,J.exports);var Z=N,U=D,V=q,Q=J.exports.orient2d;function $(e,t,r){t=Math.max(0,void 0===t?2:t),r=r||0;var n=function(e){for(var t=e[0],r=e[0],n=e[0],i=e[0],o=0;o<e.length;o++){var a=e[o];a[0]<t[0]&&(t=a),a[0]>n[0]&&(n=a),a[1]<r[1]&&(r=a),a[1]>i[1]&&(i=a)}var s=[t,r,n,i],u=s.slice();for(o=0;o<e.length;o++)V(e[o],s)||u.push(e[o]);return function(e){e.sort(ue);for(var t=[],r=0;r<e.length;r++){for(;t.length>=2&&re(t[t.length-2],t[t.length-1],e[r])<=0;)t.pop();t.push(e[r])}for(var n=[],i=e.length-1;i>=0;i--){for(;n.length>=2&&re(n[n.length-2],n[n.length-1],e[i])<=0;)n.pop();n.push(e[i])}return n.pop(),t.pop(),t.concat(n)}(u)}(e),i=new Z(16);i.toBBox=function(e){return{minX:e[0],minY:e[1],maxX:e[0],maxY:e[1]}},i.compareMinX=function(e,t){return e[0]-t[0]},i.compareMinY=function(e,t){return e[1]-t[1]},i.load(e);for(var o,a=[],s=0;s<n.length;s++){var u=n[s];i.remove(u),o=ie(u,o),a.push(o)}var l=new Z(16);for(s=0;s<a.length;s++)l.insert(ne(a[s]));for(var c=t*t,h=r*r;a.length;){var f=a.shift(),d=f.p,m=f.next.p,p=oe(d,m);if(!(p<h)){var g=p/c;(u=H(i,f.prev.p,d,m,f.next.next.p,g,l))&&Math.min(oe(u,d),oe(u,m))<=g&&(a.push(f),a.push(ie(u,f)),i.remove(u),l.remove(f),l.insert(ne(f)),l.insert(ne(f.next)))}}f=o;var v=[];do{v.push(f.p),f=f.next}while(f!==o);return v.push(f.p),v}function H(e,t,r,n,i,o,a){for(var s=new U([],K),u=e.data;u;){for(var l=0;l<u.children.length;l++){var c=u.children[l],h=u.leaf?ae(c,r,n):W(r,n,c);h>o||s.push({node:c,dist:h})}for(;s.length&&!s.peek().node.children;){var f=s.pop(),d=f.node,m=ae(d,t,r),p=ae(d,n,i);if(f.dist<m&&f.dist<p&&te(r,d,a)&&te(n,d,a))return d}(u=s.pop())&&(u=u.node)}return null}function K(e,t){return e.dist-t.dist}function W(e,t,r){if(ee(e,r)||ee(t,r))return 0;var n=se(e[0],e[1],t[0],t[1],r.minX,r.minY,r.maxX,r.minY);if(0===n)return 0;var i=se(e[0],e[1],t[0],t[1],r.minX,r.minY,r.minX,r.maxY);if(0===i)return 0;var o=se(e[0],e[1],t[0],t[1],r.maxX,r.minY,r.maxX,r.maxY);if(0===o)return 0;var a=se(e[0],e[1],t[0],t[1],r.minX,r.maxY,r.maxX,r.maxY);return 0===a?0:Math.min(n,i,o,a)}function ee(e,t){return e[0]>=t.minX&&e[0]<=t.maxX&&e[1]>=t.minY&&e[1]<=t.maxY}function te(e,t,r){for(var n,i,o,a,s=Math.min(e[0],t[0]),u=Math.min(e[1],t[1]),l=Math.max(e[0],t[0]),c=Math.max(e[1],t[1]),h=r.search({minX:s,minY:u,maxX:l,maxY:c}),f=0;f<h.length;f++)if(n=h[f].p,i=h[f].next.p,o=e,n!==(a=t)&&i!==o&&re(n,i,o)>0!=re(n,i,a)>0&&re(o,a,n)>0!=re(o,a,i)>0)return!1;return!0}function re(e,t,r){return Q(e[0],e[1],t[0],t[1],r[0],r[1])}function ne(e){var t=e.p,r=e.next.p;return e.minX=Math.min(t[0],r[0]),e.minY=Math.min(t[1],r[1]),e.maxX=Math.max(t[0],r[0]),e.maxY=Math.max(t[1],r[1]),e}function ie(e,t){var r={p:e,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return t?(r.next=t.next,r.prev=t,t.next.prev=r,t.next=r):(r.prev=r,r.next=r),r}function oe(e,t){var r=e[0]-t[0],n=e[1]-t[1];return r*r+n*n}function ae(e,t,r){var n=t[0],i=t[1],o=r[0]-n,a=r[1]-i;if(0!==o||0!==a){var s=((e[0]-n)*o+(e[1]-i)*a)/(o*o+a*a);s>1?(n=r[0],i=r[1]):s>0&&(n+=o*s,i+=a*s)}return(o=e[0]-n)*o+(a=e[1]-i)*a}function se(e,t,r,n,i,o,a,s){var u,l,c,h,f=r-e,d=n-t,m=a-i,p=s-o,g=e-i,v=t-o,y=f*f+d*d,x=f*m+d*p,b=m*m+p*p,M=f*g+d*v,w=m*g+p*v,P=y*b-x*x,E=P,L=P;0===P?(l=0,E=1,h=w,L=b):(h=y*w-x*M,(l=x*w-b*M)<0?(l=0,h=w,L=b):l>E&&(l=E,h=w+x,L=b)),h<0?(h=0,-M<0?l=0:-M>y?l=E:(l=-M,E=y)):h>L&&(h=L,-M+x<0?l=0:-M+x>y?l=E:(l=-M+x,E=y));var _=(1-(c=0===h?0:h/L))*i+c*a-((1-(u=0===l?0:l/E))*e+u*r),S=(1-c)*o+c*s-((1-u)*t+u*n);return _*_+S*S}function ue(e,t){return e[0]===t[0]?e[1]-t[1]:e[0]-t[0]}U.default&&(U=U.default),x.exports=$,x.exports.default=$;var le=v(x.exports);function ce(e){return function(e,t){void 0===t&&(t={});var r=Number(e[0]),n=Number(e[1]),i=Number(e[2]),a=Number(e[3]);if(6===e.length)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var s=[r,n];return o([[s,[i,n],[i,a],[r,a],s]],t.properties,{bbox:e,id:t.id})}(d(e))}function he(e,t,r){if(void 0===r&&(r={}),!0===r.final)return function(e,t){var r=he(t,e);return r=(r+180)%360}(e,t);var n=m(e),i=m(t),o=u(n[0]),a=u(i[0]),s=u(n[1]),l=u(i[1]),c=Math.sin(a-o)*Math.cos(l),h=Math.cos(s)*Math.sin(l)-Math.sin(s)*Math.cos(l)*Math.cos(a-o);return Math.atan2(c,h)%(2*Math.PI)*180/Math.PI}function fe(e,t){void 0===t&&(t={});var r=0,n=0,o=0;return c(e,(function(e){r+=e[0],n+=e[1],o++}),!0),i([r/o,n/o],t.properties)}function de(e,t){switch(void 0===t&&(t={}),g(e)){case"Point":return i(m(e),t.properties);case"Polygon":var r=[];c(e,(function(e){r.push(e)}));var n,a,s,u,l,h,f,d,p=fe(e,{properties:t.properties}),v=p.geometry.coordinates,y=0,x=0,b=0,M=r.map((function(e){return[e[0]-v[0],e[1]-v[1]]}));for(n=0;n<r.length-1;n++)u=(a=M[n])[0],h=a[1],l=(s=M[n+1])[0],b+=d=u*(f=s[1])-l*h,y+=(u+l)*d,x+=(h+f)*d;if(0===b)return p;var w=1/(6*(.5*b));return i([v[0]+w*y,v[1]+w*x],t.properties);default:var P=function(e,t){void 0===t&&(t={}),t.concavity=t.concavity||1/0;var r=[];if(c(e,(function(e){r.push([e[0],e[1]])})),!r.length)return null;var n=le(r,t.concavity);return n.length>3?o([n]):null}(e);return P?de(P,{properties:t.properties}):fe(e,{properties:t.properties})}}function me(e){if(!e)throw new Error("geojson is required");var t=[];return function(e,t){f(e,(function(e,r,i,o,a){var s,u=null===e?null:e.type;switch(u){case null:case"Point":case"LineString":case"Polygon":return!1!==t(n(e,i,{bbox:o,id:a}),r,0)&&void 0}switch(u){case"MultiPoint":s="Point";break;case"MultiLineString":s="LineString";break;case"MultiPolygon":s="Polygon"}for(var l=0;l<e.coordinates.length;l++){var c=e.coordinates[l];if(!1===t(n({type:s,coordinates:c},i),r,l))return!1}}))}(e,(function(e){!function(e,t){var r=[],n=e.geometry;if(null!==n){switch(n.type){case"Polygon":r=p(n);break;case"LineString":r=[p(n)]}r.forEach((function(r){var n=function(e,t){var r=[];return e.reduce((function(e,n){var i,o,s,u,l,c,h=a([e,n],t);return h.bbox=(o=n,s=(i=e)[0],u=i[1],l=o[0],c=o[1],[s<l?s:l,u<c?u:c,s>l?s:l,u>c?u:c]),r.push(h),n})),r}(r,e.properties);n.forEach((function(e){e.id=t.length,t.push(e)}))}))}}(e,t)})),s(t)}var pe={exports:{}};function ge(e,t,r,n,i){ve(e,t,r||0,n||e.length-1,i||xe)}function ve(e,t,r,n,i){for(;n>r;){if(n-r>600){var o=n-r+1,a=t-r+1,s=Math.log(o),u=.5*Math.exp(2*s/3),l=.5*Math.sqrt(s*u*(o-u)/o)*(a-o/2<0?-1:1);ve(e,t,Math.max(r,Math.floor(t-a*u/o+l)),Math.min(n,Math.floor(t+(o-a)*u/o+l)),i)}var c=e[t],h=r,f=n;for(ye(e,r,t),i(e[n],c)>0&&ye(e,r,n);h<f;){for(ye(e,h,f),h++,f--;i(e[h],c)<0;)h++;for(;i(e[f],c)>0;)f--}0===i(e[r],c)?ye(e,r,f):ye(e,++f,n),f<=t&&(r=f+1),t<=f&&(n=f-1)}}function ye(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function xe(e,t){return e<t?-1:e>t?1:0}function be(e,t,r){if(!r)return t.indexOf(e);for(let n=0;n<t.length;n++)if(r(e,t[n]))return n;return-1}function Me(e,t){we(e,0,e.children.length,t,e)}function we(e,t,r,n,i){i||(i=ke(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(let o=t;o<r;o++){const t=e.children[o];Pe(i,e.leaf?n(t):t)}return i}function Pe(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function Ee(e,t){return e.minX-t.minX}function Le(e,t){return e.minY-t.minY}function _e(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function Se(e){return e.maxX-e.minX+(e.maxY-e.minY)}function Xe(e,t){const r=Math.max(e.minX,t.minX),n=Math.max(e.minY,t.minY),i=Math.min(e.maxX,t.maxX),o=Math.min(e.maxY,t.maxY);return Math.max(0,i-r)*Math.max(0,o-n)}function Ye(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function Be(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function ke(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Ae(e,t,r,n,i){const o=[t,r];for(;o.length;){if((r=o.pop())-(t=o.pop())<=n)continue;const a=t+Math.ceil((r-t)/n/2)*n;ge(e,a,t,r,i),o.push(t,a,a,r)}}var Fe=Object.freeze({__proto__:null,default:class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const r=[];if(!Be(e,t))return r;const n=this.toBBox,i=[];for(;t;){for(let o=0;o<t.children.length;o++){const a=t.children[o],s=t.leaf?n(a):a;Be(e,s)&&(t.leaf?r.push(a):Ye(e,s)?this._all(a,r):i.push(a))}t=i.pop()}return r}collides(e){let t=this.data;if(!Be(e,t))return!1;const r=[];for(;t;){for(let n=0;n<t.children.length;n++){const i=t.children[n],o=t.leaf?this.toBBox(i):i;if(Be(e,o)){if(t.leaf||Ye(e,o))return!0;r.push(i)}}t=r.pop()}return!1}load(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(let t=0;t<e.length;t++)this.insert(e[t]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const e=this.data;this.data=t,t=e}this._insert(t,this.data.height-t.height-1,!0)}else this.data=t;return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=ke([]),this}remove(e,t){if(!e)return this;let r=this.data;const n=this.toBBox(e),i=[],o=[];let a,s,u;for(;r||i.length;){if(r||(r=i.pop(),s=i[i.length-1],a=o.pop(),u=!0),r.leaf){const n=be(e,r.children,t);if(-1!==n)return r.children.splice(n,1),i.push(r),this._condense(i),this}u||r.leaf||!Ye(r,n)?s?(a++,r=s.children[a],u=!1):r=null:(i.push(r),o.push(a),a=0,s=r,r=r.children[0])}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const r=[];for(;e;)e.leaf?t.push(...e.children):r.push(...e.children),e=r.pop();return t}_build(e,t,r,n){const i=r-t+1;let o,a=this._maxEntries;if(i<=a)return o=ke(e.slice(t,r+1)),Me(o,this.toBBox),o;n||(n=Math.ceil(Math.log(i)/Math.log(a)),a=Math.ceil(i/Math.pow(a,n-1))),o=ke([]),o.leaf=!1,o.height=n;const s=Math.ceil(i/a),u=s*Math.ceil(Math.sqrt(a));Ae(e,t,r,u,this.compareMinX);for(let i=t;i<=r;i+=u){const t=Math.min(i+u-1,r);Ae(e,i,t,s,this.compareMinY);for(let r=i;r<=t;r+=s){const i=Math.min(r+s-1,t);o.children.push(this._build(e,r,i,n-1))}}return Me(o,this.toBBox),o}_chooseSubtree(e,t,r,n){for(;n.push(t),!t.leaf&&n.length-1!==r;){let r,n=1/0,a=1/0;for(let s=0;s<t.children.length;s++){const u=t.children[s],l=_e(u),c=(i=e,o=u,(Math.max(o.maxX,i.maxX)-Math.min(o.minX,i.minX))*(Math.max(o.maxY,i.maxY)-Math.min(o.minY,i.minY))-l);c<a?(a=c,n=l<n?l:n,r=u):c===a&&l<n&&(n=l,r=u)}t=r||t.children[0]}var i,o;return t}_insert(e,t,r){const n=r?e:this.toBBox(e),i=[],o=this._chooseSubtree(n,this.data,t,i);for(o.children.push(e),Pe(o,n);t>=0&&i[t].children.length>this._maxEntries;)this._split(i,t),t--;this._adjustParentBBoxes(n,i,t)}_split(e,t){const r=e[t],n=r.children.length,i=this._minEntries;this._chooseSplitAxis(r,i,n);const o=this._chooseSplitIndex(r,i,n),a=ke(r.children.splice(o,r.children.length-o));a.height=r.height,a.leaf=r.leaf,Me(r,this.toBBox),Me(a,this.toBBox),t?e[t-1].children.push(a):this._splitRoot(r,a)}_splitRoot(e,t){this.data=ke([e,t]),this.data.height=e.height+1,this.data.leaf=!1,Me(this.data,this.toBBox)}_chooseSplitIndex(e,t,r){let n,i=1/0,o=1/0;for(let a=t;a<=r-t;a++){const t=we(e,0,a,this.toBBox),s=we(e,a,r,this.toBBox),u=Xe(t,s),l=_e(t)+_e(s);u<i?(i=u,n=a,o=l<o?l:o):u===i&&l<o&&(o=l,n=a)}return n||r-t}_chooseSplitAxis(e,t,r){const n=e.leaf?this.compareMinX:Ee,i=e.leaf?this.compareMinY:Le;this._allDistMargin(e,t,r,n)<this._allDistMargin(e,t,r,i)&&e.children.sort(n)}_allDistMargin(e,t,r,n){e.children.sort(n);const i=this.toBBox,o=we(e,0,t,i),a=we(e,r-t,r,i);let s=Se(o)+Se(a);for(let n=t;n<r-t;n++){const t=e.children[n];Pe(o,e.leaf?i(t):t),s+=Se(o)}for(let n=r-t-1;n>=t;n--){const t=e.children[n];Pe(a,e.leaf?i(t):t),s+=Se(a)}return s}_adjustParentBBoxes(e,t,r){for(let n=r;n>=0;n--)Pe(t[n],e)}_condense(e){for(let t,r=e.length-1;r>=0;r--)0===e[r].children.length?r>0?(t=e[r-1].children,t.splice(t.indexOf(e[r]),1)):this.clear():Me(e[r],this.toBBox)}}}),Ce=y(Fe),Ie={};!function(e){function t(e,t,r){void 0===r&&(r={});var n={type:"Feature"};return(0===r.id||r.id)&&(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=t||{},n.geometry=e,n}function r(e,r,n){if(void 0===n&&(n={}),!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!f(e[0])||!f(e[1]))throw new Error("coordinates must contain numbers");return t({type:"Point",coordinates:e},r,n)}function n(e,r,n){void 0===n&&(n={});for(var i=0,o=e;i<o.length;i++){var a=o[i];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<a[a.length-1].length;s++)if(a[a.length-1][s]!==a[0][s])throw new Error("First and last Position are not equivalent.")}return t({type:"Polygon",coordinates:e},r,n)}function i(e,r,n){if(void 0===n&&(n={}),e.length<2)throw new Error("coordinates must be an array of two or more positions");return t({type:"LineString",coordinates:e},r,n)}function o(e,t){void 0===t&&(t={});var r={type:"FeatureCollection"};return t.id&&(r.id=t.id),t.bbox&&(r.bbox=t.bbox),r.features=e,r}function a(e,r,n){return void 0===n&&(n={}),t({type:"MultiLineString",coordinates:e},r,n)}function s(e,r,n){return void 0===n&&(n={}),t({type:"MultiPoint",coordinates:e},r,n)}function u(e,r,n){return void 0===n&&(n={}),t({type:"MultiPolygon",coordinates:e},r,n)}function l(t,r){void 0===r&&(r="kilometers");var n=e.factors[r];if(!n)throw new Error(r+" units is invalid");return t*n}function c(t,r){void 0===r&&(r="kilometers");var n=e.factors[r];if(!n)throw new Error(r+" units is invalid");return t/n}function h(e){return 180*(e%(2*Math.PI))/Math.PI}function f(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.earthRadius=6371008.8,e.factors={centimeters:100*e.earthRadius,centimetres:100*e.earthRadius,degrees:e.earthRadius/111325,feet:3.28084*e.earthRadius,inches:39.37*e.earthRadius,kilometers:e.earthRadius/1e3,kilometres:e.earthRadius/1e3,meters:e.earthRadius,metres:e.earthRadius,miles:e.earthRadius/1609.344,millimeters:1e3*e.earthRadius,millimetres:1e3*e.earthRadius,nauticalmiles:e.earthRadius/1852,radians:1,yards:1.0936*e.earthRadius},e.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/e.earthRadius,yards:1.0936133},e.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},e.feature=t,e.geometry=function(e,t,o){switch(e){case"Point":return r(t).geometry;case"LineString":return i(t).geometry;case"Polygon":return n(t).geometry;case"MultiPoint":return s(t).geometry;case"MultiLineString":return a(t).geometry;case"MultiPolygon":return u(t).geometry;default:throw new Error(e+" is invalid")}},e.point=r,e.points=function(e,t,n){return void 0===n&&(n={}),o(e.map((function(e){return r(e,t)})),n)},e.polygon=n,e.polygons=function(e,t,r){return void 0===r&&(r={}),o(e.map((function(e){return n(e,t)})),r)},e.lineString=i,e.lineStrings=function(e,t,r){return void 0===r&&(r={}),o(e.map((function(e){return i(e,t)})),r)},e.featureCollection=o,e.multiLineString=a,e.multiPoint=s,e.multiPolygon=u,e.geometryCollection=function(e,r,n){return void 0===n&&(n={}),t({type:"GeometryCollection",geometries:e},r,n)},e.round=function(e,t){if(void 0===t&&(t=0),t&&!(t>=0))throw new Error("precision must be a positive number");var r=Math.pow(10,t||0);return Math.round(e*r)/r},e.radiansToLength=l,e.lengthToRadians=c,e.lengthToDegrees=function(e,t){return h(c(e,t))},e.bearingToAzimuth=function(e){var t=e%360;return t<0&&(t+=360),t},e.radiansToDegrees=h,e.degreesToRadians=function(e){return e%360*Math.PI/180},e.convertLength=function(e,t,r){if(void 0===t&&(t="kilometers"),void 0===r&&(r="kilometers"),!(e>=0))throw new Error("length must be a positive number");return l(c(e,t),r)},e.convertArea=function(t,r,n){if(void 0===r&&(r="meters"),void 0===n&&(n="kilometers"),!(t>=0))throw new Error("area must be a positive number");var i=e.areaFactors[r];if(!i)throw new Error("invalid original units");var o=e.areaFactors[n];if(!o)throw new Error("invalid final units");return t/i*o},e.isNumber=f,e.isObject=function(e){return!!e&&e.constructor===Object},e.validateBBox=function(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(4!==e.length&&6!==e.length)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach((function(e){if(!f(e))throw new Error("bbox must only contain numbers")}))},e.validateId=function(e){if(!e)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof e))throw new Error("id must be a number or a string")}}(Ie);var Oe={};Object.defineProperty(Oe,"__esModule",{value:!0});var Re=Ie;function Ne(e,t,r){if(null!==e)for(var n,i,o,a,s,u,l,c,h=0,f=0,d=e.type,m="FeatureCollection"===d,p="Feature"===d,g=m?e.features.length:1,v=0;v<g;v++){s=(c=!!(l=m?e.features[v].geometry:p?e.geometry:e)&&"GeometryCollection"===l.type)?l.geometries.length:1;for(var y=0;y<s;y++){var x=0,b=0;if(null!==(a=c?l.geometries[y]:l)){u=a.coordinates;var M=a.type;switch(h=!r||"Polygon"!==M&&"MultiPolygon"!==M?0:1,M){case null:break;case"Point":if(!1===t(u,f,v,x,b))return!1;f++,x++;break;case"LineString":case"MultiPoint":for(n=0;n<u.length;n++){if(!1===t(u[n],f,v,x,b))return!1;f++,"MultiPoint"===M&&x++}"LineString"===M&&x++;break;case"Polygon":case"MultiLineString":for(n=0;n<u.length;n++){for(i=0;i<u[n].length-h;i++){if(!1===t(u[n][i],f,v,x,b))return!1;f++}"MultiLineString"===M&&x++,"Polygon"===M&&b++}"Polygon"===M&&x++;break;case"MultiPolygon":for(n=0;n<u.length;n++){for(b=0,i=0;i<u[n].length;i++){for(o=0;o<u[n][i].length-h;o++){if(!1===t(u[n][i][o],f,v,x,b))return!1;f++}b++}x++}break;case"GeometryCollection":for(n=0;n<a.geometries.length;n++)if(!1===Ne(a.geometries[n],t,r))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function je(e,t){var r;switch(e.type){case"FeatureCollection":for(r=0;r<e.features.length&&!1!==t(e.features[r].properties,r);r++);break;case"Feature":t(e.properties,0)}}function De(e,t){if("Feature"===e.type)t(e,0);else if("FeatureCollection"===e.type)for(var r=0;r<e.features.length&&!1!==t(e.features[r],r);r++);}function ze(e,t){var r,n,i,o,a,s,u,l,c,h,f=0,d="FeatureCollection"===e.type,m="Feature"===e.type,p=d?e.features.length:1;for(r=0;r<p;r++){for(s=d?e.features[r].geometry:m?e.geometry:e,l=d?e.features[r].properties:m?e.properties:{},c=d?e.features[r].bbox:m?e.bbox:void 0,h=d?e.features[r].id:m?e.id:void 0,a=(u=!!s&&"GeometryCollection"===s.type)?s.geometries.length:1,i=0;i<a;i++)if(null!==(o=u?s.geometries[i]:s))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===t(o,f,l,c,h))return!1;break;case"GeometryCollection":for(n=0;n<o.geometries.length;n++)if(!1===t(o.geometries[n],f,l,c,h))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===t(null,f,l,c,h))return!1;f++}}function Te(e,t){ze(e,(function(e,r,n,i,o){var a,s=null===e?null:e.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return!1!==t(Re.feature(e,n,{bbox:i,id:o}),r,0)&&void 0}switch(s){case"MultiPoint":a="Point";break;case"MultiLineString":a="LineString";break;case"MultiPolygon":a="Polygon"}for(var u=0;u<e.coordinates.length;u++){var l={type:a,coordinates:e.coordinates[u]};if(!1===t(Re.feature(l,n),r,u))return!1}}))}function Ge(e,t){Te(e,(function(e,r,n){var i=0;if(e.geometry){var o=e.geometry.type;if("Point"!==o&&"MultiPoint"!==o){var a,s=0,u=0,l=0;return!1!==Ne(e,(function(o,c,h,f,d){if(void 0===a||r>s||f>u||d>l)return a=o,s=r,u=f,l=d,void(i=0);var m=Re.lineString([a,o],e.properties);if(!1===t(m,r,n,d,i))return!1;i++,a=o}))&&void 0}}}))}function qe(e,t){if(!e)throw new Error("geojson is required");Te(e,(function(e,r,n){if(null!==e.geometry){var i=e.geometry.type,o=e.geometry.coordinates;switch(i){case"LineString":if(!1===t(e,r,n,0,0))return!1;break;case"Polygon":for(var a=0;a<o.length;a++)if(!1===t(Re.lineString(o[a],e.properties),r,n,a))return!1}}}))}Oe.coordAll=function(e){var t=[];return Ne(e,(function(e){t.push(e)})),t},Oe.coordEach=Ne,Oe.coordReduce=function(e,t,r,n){var i=r;return Ne(e,(function(e,n,o,a,s){i=0===n&&void 0===r?e:t(i,e,n,o,a,s)}),n),i},Oe.featureEach=De,Oe.featureReduce=function(e,t,r){var n=r;return De(e,(function(e,i){n=0===i&&void 0===r?e:t(n,e,i)})),n},Oe.findPoint=function(e,t){if(t=t||{},!Re.isObject(t))throw new Error("options is invalid");var r,n=t.featureIndex||0,i=t.multiFeatureIndex||0,o=t.geometryIndex||0,a=t.coordIndex||0,s=t.properties;switch(e.type){case"FeatureCollection":n<0&&(n=e.features.length+n),s=s||e.features[n].properties,r=e.features[n].geometry;break;case"Feature":s=s||e.properties,r=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=e;break;default:throw new Error("geojson is invalid")}if(null===r)return null;var u=r.coordinates;switch(r.type){case"Point":return Re.point(u,s,t);case"MultiPoint":return i<0&&(i=u.length+i),Re.point(u[i],s,t);case"LineString":return a<0&&(a=u.length+a),Re.point(u[a],s,t);case"Polygon":return o<0&&(o=u.length+o),a<0&&(a=u[o].length+a),Re.point(u[o][a],s,t);case"MultiLineString":return i<0&&(i=u.length+i),a<0&&(a=u[i].length+a),Re.point(u[i][a],s,t);case"MultiPolygon":return i<0&&(i=u.length+i),o<0&&(o=u[i].length+o),a<0&&(a=u[i][o].length-a),Re.point(u[i][o][a],s,t)}throw new Error("geojson is invalid")},Oe.findSegment=function(e,t){if(t=t||{},!Re.isObject(t))throw new Error("options is invalid");var r,n=t.featureIndex||0,i=t.multiFeatureIndex||0,o=t.geometryIndex||0,a=t.segmentIndex||0,s=t.properties;switch(e.type){case"FeatureCollection":n<0&&(n=e.features.length+n),s=s||e.features[n].properties,r=e.features[n].geometry;break;case"Feature":s=s||e.properties,r=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=e;break;default:throw new Error("geojson is invalid")}if(null===r)return null;var u=r.coordinates;switch(r.type){case"Point":case"MultiPoint":return null;case"LineString":return a<0&&(a=u.length+a-1),Re.lineString([u[a],u[a+1]],s,t);case"Polygon":return o<0&&(o=u.length+o),a<0&&(a=u[o].length+a-1),Re.lineString([u[o][a],u[o][a+1]],s,t);case"MultiLineString":return i<0&&(i=u.length+i),a<0&&(a=u[i].length+a-1),Re.lineString([u[i][a],u[i][a+1]],s,t);case"MultiPolygon":return i<0&&(i=u.length+i),o<0&&(o=u[i].length+o),a<0&&(a=u[i][o].length-a-1),Re.lineString([u[i][o][a],u[i][o][a+1]],s,t)}throw new Error("geojson is invalid")},Oe.flattenEach=Te,Oe.flattenReduce=function(e,t,r){var n=r;return Te(e,(function(e,i,o){n=0===i&&0===o&&void 0===r?e:t(n,e,i,o)})),n},Oe.geomEach=ze,Oe.geomReduce=function(e,t,r){var n=r;return ze(e,(function(e,i,o,a,s){n=0===i&&void 0===r?e:t(n,e,i,o,a,s)})),n},Oe.lineEach=qe,Oe.lineReduce=function(e,t,r){var n=r;return qe(e,(function(e,i,o,a){n=0===i&&void 0===r?e:t(n,e,i,o,a)})),n},Oe.propEach=je,Oe.propReduce=function(e,t,r){var n=r;return je(e,(function(e,i){n=0===i&&void 0===r?e:t(n,e,i)})),n},Oe.segmentEach=Ge,Oe.segmentReduce=function(e,t,r){var n=r,i=!1;return Ge(e,(function(e,o,a,s,u){n=!1===i&&void 0===r?e:t(n,e,o,a,s,u),i=!0})),n};var Je={};Object.defineProperty(Je,"__esModule",{value:!0});var Ze=Oe;function Ue(e){var t=[1/0,1/0,-1/0,-1/0];return Ze.coordEach(e,(function(e){t[0]>e[0]&&(t[0]=e[0]),t[1]>e[1]&&(t[1]=e[1]),t[2]<e[0]&&(t[2]=e[0]),t[3]<e[1]&&(t[3]=e[1])})),t}Ue.default=Ue,Je.default=Ue;var Ve=Ce,Qe=Ie,$e=Oe,He=Je.default,Ke=$e.featureEach;$e.coordEach;var We=Qe.featureCollection;function et(e){var t=new Ve(e);return t.insert=function(e){if("Feature"!==e.type)throw new Error("invalid feature");return e.bbox=e.bbox?e.bbox:He(e),Ve.prototype.insert.call(this,e)},t.load=function(e){var t=[];return Array.isArray(e)?e.forEach((function(e){if("Feature"!==e.type)throw new Error("invalid features");e.bbox=e.bbox?e.bbox:He(e),t.push(e)})):Ke(e,(function(e){if("Feature"!==e.type)throw new Error("invalid features");e.bbox=e.bbox?e.bbox:He(e),t.push(e)})),Ve.prototype.load.call(this,t)},t.remove=function(e,t){if("Feature"!==e.type)throw new Error("invalid feature");return e.bbox=e.bbox?e.bbox:He(e),Ve.prototype.remove.call(this,e,t)},t.clear=function(){return Ve.prototype.clear.call(this)},t.search=function(e){var t=Ve.prototype.search.call(this,this.toBBox(e));return We(t)},t.collides=function(e){return Ve.prototype.collides.call(this,this.toBBox(e))},t.all=function(){var e=Ve.prototype.all.call(this);return We(e)},t.toJSON=function(){return Ve.prototype.toJSON.call(this)},t.fromJSON=function(e){return Ve.prototype.fromJSON.call(this,e)},t.toBBox=function(e){var t;if(e.bbox)t=e.bbox;else if(Array.isArray(e)&&4===e.length)t=e;else if(Array.isArray(e)&&6===e.length)t=[e[0],e[1],e[3],e[4]];else if("Feature"===e.type)t=He(e);else{if("FeatureCollection"!==e.type)throw new Error("invalid geojson");t=He(e)}return{minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]}},t}pe.exports=et,pe.exports.default=et;var tt,rt=v(pe.exports);function nt(e,t){var r={},i=[];if("LineString"===e.type&&(e=n(e)),"LineString"===t.type&&(t=n(t)),"Feature"===e.type&&"Feature"===t.type&&null!==e.geometry&&null!==t.geometry&&"LineString"===e.geometry.type&&"LineString"===t.geometry.type&&2===e.geometry.coordinates.length&&2===t.geometry.coordinates.length){var o=it(e,t);return o&&i.push(o),s(i)}var a=rt();return a.load(me(t)),h(me(e),(function(e){h(a.search(e),(function(t){var n=it(e,t);if(n){var o=p(n).join(",");r[o]||(r[o]=!0,i.push(n))}}))})),s(i)}function it(e,t){var r=p(e),n=p(t);if(2!==r.length)throw new Error("<intersects> line1 must only contain 2 coordinates");if(2!==n.length)throw new Error("<intersects> line2 must only contain 2 coordinates");var o=r[0][0],a=r[0][1],s=r[1][0],u=r[1][1],l=n[0][0],c=n[0][1],h=n[1][0],f=n[1][1],d=(f-c)*(s-o)-(h-l)*(u-a),m=(h-l)*(a-c)-(f-c)*(o-l),g=(s-o)*(a-c)-(u-a)*(o-l);if(0===d)return null;var v=m/d,y=g/d;return v>=0&&v<=1&&y>=0&&y<=1?i([o+v*(s-o),a+v*(u-a)]):null}function ot(e,t,n,i){void 0===i&&(i={}),e.addSource(t,r({type:"geojson",data:n},i))}function at(e,t){e.addLayer(t)}function st(e,t){return he(i(e),i(t))}function ut(e,t){return void 0===t&&(t=180),e-t}function lt(e,t,r){var n=d(t);r&&e.fitBounds(n,{padding:{top:r[0],bottom:r[1],left:r[2],right:r[3]}})}function ct(e,t){return e.filter((function(e){return t===g(e)}))}function ht(e){return e.map((function(e){return m(e)}))}function ft(e){if(!e)return[];var t=[];return f(e,(function(e){var r=p(e);t.push(r[0]),t.push(r[r.length-1])})),t}function dt(e){if(!e)return[];var t=[];return f(e,(function(e){var r,n,o=(n=[],"FeatureCollection"===(r=e).type?h(r,(function(e){c(e,(function(t){n.push(i(t,e.properties))}))})):c(r,(function(e){n.push(i(e,r.properties))})),s(n));h(o,(function(e){var r=m(e);t.push(r)}))})),t}!function(e){e.Point="Point",e.LineString="LineString",e.MultiLineString="MultiLineString",e.Polygon="Polygon",e.MultiPolygon="MultiPolygon"}(tt||(tt={})),e.checkCoordinate=function(e){var t="坐标应该为一个只有两个元素的数组";if(!Array.isArray(e))throw new Error(t);if(Array.isArray(e)&&e.length>2)throw new Error(t);if("number"!=typeof e[0]||"number"!=typeof e[1])throw new Error("坐标值应是 number")},e.clearAllSourceAndLayer=function(e,t){for(var r in t)r.toLocaleLowerCase().includes("layer")&&e.getLayer(t[r])&&e.removeLayer(t[r]),r.toLocaleLowerCase().includes("source")&&e.getSource(t[r])&&e.removeSource(t[r])},e.destroyMap=function(e){e&&e.remove()},e.getBearing=st,e.getCenterBetweenRightPointIntersection=function(e){var t=Math.max.apply(Math,e.map((function(e){return e[0]}))),r=e.find((function(e){return e[0]===t}));if(r){var n=[r[0],r[1]+.5],i=[r[0],r[1]-.5],s=m(de(o([e]))),u=[s[0]+.5,s[1]],l=[s[0]-.5,s[1]];return m(nt(a([r,n,i],{name:"line 1"}),a([s,u,l],{name:"line 2"})).features[0])}},e.getFeatureTypeList=ct,e.getLineEndpoint=function(){var e=116.46,t=39.92,r=ft(s([a([[e-.005,t+.005],[e-.005,t-.005]]),a([[e-.005,t],[e,t],[e+.009,t]])]));console.log("lineStringEndpoint",r)},e.getLineStringEndpoint=ft,e.getPolygonVertex=dt,e.getPopupDom=function(e,r){var n=t.createApp(e,r),i=document.createElement("div");return n.mount(i).$el},e.getRotation=ut,e.getRotationByCoordinate=function(e,t,r){return void 0===r&&(r=180),ut(st(e,t),r)},e.hiddenLayer=function(e,t){e&&e.getLayer(t)&&e.setLayoutProperty(t,"visibility","none")},e.hiddenLayers=function(e,t){Array.isArray(t)&&t.length>0&&t.forEach((function(t){e.getLayer(t)&&e.setLayoutProperty(t,"visibility","none")}))},e.moveAndZoom=function(e,t,r){void 0===r&&(r=12),e.easeTo({center:t,zoom:r})},e.moveMap=function(e,t){e.panTo(t)},e.pointListToCoordList=ht,e.removeMarkers=function(e){Array.isArray(e)?e.forEach((function(e){return e&&e.remove()})):console.error("value markers is not array")},e.removeMarkersOrPopups=function(e){Array.isArray(e)?e.forEach((function(e){return e.remove()})):console.error("list is not array")},e.setLayerIdName=function(e,t){return void 0===t&&(t=""),"".concat(e,"-").concat(t,"-layer")},e.setMultipleLayerSourceData=function(e,t,r,n,i){void 0===i&&(i={});try{var o=i.afterSetData,a=i.afterSetLayer,s=i.sourceOption,u=void 0===s?{}:s,l=e.getSource(t);l?(l.setData(n),Array.isArray(r)&&r.forEach((function(t){o&&o(e,t.id)}))):(ot(e,t,n,u),Array.isArray(r)&&r.forEach((function(t){at(e,t),a&&a(e,t.id)})))}catch(e){}},e.setPbfSourceData=function(e,t,r,n,i){void 0===i&&(i={});var o=i.useToken,a=void 0!==o&&o,s=i.token;a&&(n=n.map((function(e){return e+s}))),e.getSource(t)||(e.addSource(t,{type:"vector",tiles:n}),at(e,r))},e.setSourceData=function(e,t,r,n,i){void 0===i&&(i={});try{var o=i.afterSetData,a=i.afterSetLayer,s=i.sourceOption,u=e.getSource(t);u?(u.setData(n),o&&o(e,r.id)):(ot(e,t,n,s),at(e,r),a&&a(e,r.id))}catch(e){console.error(e)}},e.setSourceIdName=function(e,t){return void 0===t&&(t=""),"".concat(e,"-").concat(t,"-source")},e.setViewPort=function(e,t,r){if(void 0===t&&(t=[]),void 0===r&&(r={}),e){var n=r.boundary,o=void 0===n?[150,250,150,250]:n,a=ct(t,tt.Point),u=ct(t,tt.LineString),l=ct(t,tt.MultiLineString),c=ct(t,tt.Polygon),h=ct(t,tt.MultiPolygon),f=ht(a).concat(ft(s(u))).concat(ft(s(l))).concat(dt(s(c))).concat(dt(s(h)));if(f.length>0){var d=ce(s(f.map((function(e){return i(e)}))));d.bbox?e.fitBounds(d.bbox,{padding:{top:o[0],bottom:o[1],left:o[2],right:o[3]}}):lt(e,d,o)}}},e.setViewPortByPolygon=lt,e.setZoom=function(e,t){t>10&&e.setZoom(t)},e.showLayer=function(e,t){e&&e.getLayer(t)&&e.setLayoutProperty(t,"visibility","visible")},e.showLayers=function(e,t){Array.isArray(t)&&t.length>0&&t.forEach((function(t){e.getLayer(t)&&e.setLayoutProperty(t,"visibility","visible")}))},e.useMap=function(e){var r=e.map,n=void 0===r?null:r,i=e.bindClickLayers,o=void 0===i?[]:i,a=e.bindMouseMoveLayers,s=void 0===a?[]:a,u=e.bindZoomLayers,l=void 0===u?[]:u,c=e.zoomQueryBy,h=void 0===c?"mouse":c,f=t.ref(n),d=t.reactive({lng:0,lat:0,x:0,y:0});f.value&&f.value&&(f.value.on("click",y),f.value.on("mousemove",v),f.value.on("zoomend",g));var m=t.reactive({onMapLoaded:void 0,clickLayerEventDispatcher:void 0,clickNoInLayer:void 0,mouseMoveLayerEventDispatcher:void 0,moveNoInLayer:void 0,zoomLayerEventDispatcher:void 0,zoomNoInLayer:void 0});function p(){f.value&&(f.value.off("click",y),f.value.off("mousemove",v),f.value.off("zoomend",g))}function g(e){var t,r,n=null==f?void 0:f.value.getZoom(),i=null==f?void 0:f.value.getCenter();if("mouse"===h?r=[d.x,d.y]:"map"===h&&(r=[i.lng,i.lat]),r){var o=null===(t=null==f?void 0:f.value)||void 0===t?void 0:t.queryRenderedFeatures(r,{layers:l});if(Array.isArray(o)&&o.length>0){var a=o[0],s=a.layer.id;a&&l.includes(s)&&m.zoomLayerEventDispatcher&&m.zoomLayerEventDispatcher({zoom:n,layerId:s,feature:a,mapEvent:e,mouseCoordinate:[d.lng,d.lat],mapCenterCoordinate:[i.lng,i.lat]})}else m.zoomNoInLayer&&m.zoomNoInLayer(e)}}function v(e){var t;!function(e){var t=e.lngLat,r=t.lng,n=t.lat,i=e.point,o=i.x,a=i.y;d.lng=r,d.lat=n,d.x=o,d.y=a}(e);var r=null===(t=null==f?void 0:f.value)||void 0===t?void 0:t.queryRenderedFeatures(e.point,{layers:s});if(Array.isArray(r)&&r.length>0){var n=r[0],i=n.layer.id;n&&s.includes(i)&&m.mouseMoveLayerEventDispatcher&&m.mouseMoveLayerEventDispatcher({layerId:i,feature:n,mapEvent:e})}else m.moveNoInLayer&&m.moveNoInLayer(e)}function y(e){var t,r=null===(t=null==f?void 0:f.value)||void 0===t?void 0:t.queryRenderedFeatures(e.point,{layers:o||[]});if(Array.isArray(r)&&r.length>0){var n=r[0],i=n.layer.id;n&&o.includes(i)&&m.clickLayerEventDispatcher&&m.clickLayerEventDispatcher({layerId:i,feature:n,mapEvent:e})}else m.clickNoInLayer&&m.clickNoInLayer(e)}return t.onUnmounted((function(){p()})),{mapInstance:f,mapInitialize:function(e){f.value||(f.value=e,m.onMapLoaded&&m.onMapLoaded(e),f.value.on("click",y),f.value.on("mousemove",v),f.value.on("zoomend",g))},onMapLoaded:function(e){m.onMapLoaded=e},onClickLayerEventDispatcher:function(e){m.clickLayerEventDispatcher=e},onClickNoInLayers:function(e){m.clickNoInLayer=e},onMouseMoveLayerEventDispatcher:function(e){m.mouseMoveLayerEventDispatcher=e},onMoveNoInLayers:function(e){m.moveNoInLayer=e},onZoomLayerEventDispatcher:function(e){m.zoomLayerEventDispatcher=e},onZoomNoInLayers:function(e){m.zoomNoInLayer=e},unBindMapEvent:p}}}));
